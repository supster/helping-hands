<% provide(:title, 'Helping Hands')%>  
<% content_for :head do %>
<script type="text/javascript">
	function takeAction(nextStateID, saveAction){
		$("#next_state_id").val(nextStateID);
		$("#save").val(saveAction);
		//return true;
	}

	function takeValue(nextStateID, saveAttribute){
		$("#next_state_id").val(nextStateID);
		$("#save").val(saveAttribute + $("#input_value").val());
	}
</script>
<% end %>
<div>
	<h3><%= @workflow.name %></h3>
	<h4><%= @state.description.html_safe %></h4>	
	<% if @state.action_type.name == "YesNo" %>
		<%= form_tag(workflow_state_path(@workflow_id, @state.id), method: "get") do %>
			<%= hidden_field_tag "save" %>
			<%= hidden_field_tag "next_state_id" %>
			<% @actions.each do |ac| %>
				<%= button_tag 	ac.name, name: "action_id", value: ac.id, 
				onclick: "takeAction('#{ac.next_state_id}','#{ac.save_attr}');", class: "btn btn-medium btn-primary" %>
			<% end %>
		<% end %>
	<% elsif @state.action_type.name == "InputForm" %>
		<%= form_tag(workflow_state_path(@workflow_id, @state.id), method: "get") do %>
			<% if @state.form_name == "show_household" %>
				<%= select_tag "input_value", 
				options_for_select([[1,1], [2,2], [3,3], [4,4], [5,5], [6,6], [7,7], [8,8], [9,9]]) %><br/>
			<% elsif @state.form_name == "show_monthly_income" %>
				<%= text_field_tag "input_value" %><br/>
			<% end %>
			<%= hidden_field_tag "save" %>
			<%= hidden_field_tag "next_state_id" %>
			<%= button_tag "Next", name: "action_id", value: @actions.first.id, 
							onclick: "takeValue('#{@actions.first.next_state_id}','#{@actions.first.save_attr}');",
							class: "btn btn-medium btn btn-primary" if @actions.count > 0 %>
		<% end %>
	<% end %>
</div>
